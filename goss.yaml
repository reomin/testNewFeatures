http:
  http://localhost:9200/_cluster/health:
    status: 200
    timeout: 10000
    body:
      - '"status":"green"'
      - '"status":"yellow"'

  http://localhost:8080/health.php:
    status: 200
    timeout: 5000
    body:
      - '"status":"healthy"'

  http://localhost:8080/todosGet.php:
    status: 200
    timeout: 5000

  http://localhost:5173:
    status: 200
    timeout: 5000

command:
  mysql-connection:
    exec: "docker exec -i $(docker compose ps -q db) mysql -u user -ppassword -e 'SELECT 1'"
    exit-status: 0
    timeout: 10000

  redis-ping:
    exec: "docker exec -i $(docker compose ps -q redis) redis-cli ping"
    exit-status: 0
    timeout: 5000
    stdout:
      - "PONG"

  backend-redis:
    exec: 'docker exec -i $(docker compose ps -q app) php -r "try { $redis = new Redis(); $redis->connect(\"redis\", 6379); echo \"OK\"; } catch (Exception $e) { exit(1); }"'
    exit-status: 0
    timeout: 10000
    stdout:
      - "OK"

  backend-elasticsearch:
    exec: 'docker exec -i $(docker compose ps -q app) php -r "try { $ch = curl_init(\"http://elasticsearch:9200\"); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); $result = curl_exec($ch); $code = curl_getinfo($ch, CURLINFO_HTTP_CODE); curl_close($ch); if ($code == 200) echo \"OK\"; else exit(1); } catch (Exception $e) { exit(1); }"'
    exit-status: 0
    timeout: 10000
    stdout:
      - "OK"
